const {merge} = require('ramda')
const {getPaths, SYS_AUTO_API_PREFIX} = require('./util')
const modelServices = require('./auto-model-service').services
const {getConfig} = require('./config')


let services = {...modelServices};

const paths = getPaths(getConfig('api_dir'), 'biz.js');
for (const filePath of paths) {
    const fileServices = require(filePath);
    for (let api in fileServices) {
        const exist = SYS_AUTO_API_PREFIX.find(x => api.startsWith(x));
        if (exist) {
            console.log('ERROR: ======================your api can not be start with ' + sys + ' in ' + api + '==================')
            return
        }
    }
    services = {...services, ...fileServices}
}

module.exports = {services}